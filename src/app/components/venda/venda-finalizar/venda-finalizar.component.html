<div class="venda-container">
  <nz-card>
    <ng-container *ngIf="!pedidoRealizado">
      <!-- Header com total -->
      <div class="header-total">
        <h2>Total a Pagar</h2>
        <div class="valor-total">{{ valorTotal | currency : "BRL" }}</div>
      </div>

      <form [formGroup]="vendaForm" (ngSubmit)="finalizarVenda()">

        <!-- Endereço -->
        <section class="endereco-section" *ngIf="cliente">
          <h3><i nz-icon nzType="environment"></i> Endereço de Entrega</h3>
          <div class="endereco-card">
            <div class="endereco-principal">
              {{ cliente.rua }}, {{ cliente.numero }}
            </div>
            <div class="endereco-complemento">
              {{ cliente.bairro }} - {{ cliente.cidade }}/{{ cliente.estado }}
            </div>
            <div class="endereco-cep">CEP: {{ cliente.cep }}</div>
          </div>
        </section>

        <!-- Pagamento -->
        <section class="pagamento-section">
          <h3><i nz-icon nzType="credit-card"></i> Forma de Pagamento</h3>
          <nz-select formControlName="pagamento" nzBlock>
            <nz-option
              *ngFor="let pag of pagamentos"
              [nzValue]="pag"
              [nzLabel]="pag.nome"
            >
            </nz-option>
          </nz-select>
        </section>

        <!-- Resumo -->
        <section class="resumo-section">
          <div class="resumo-item">
            <span>Subtotal</span>
            <span>{{ valorParcial | currency : "BRL" }}</span>
          </div>
          <div class="resumo-item" >
            <span>Acréscimo</span>
            <span>{{ acrescimo }}%</span>
          </div>
          <div class="resumo-item total">
            <span>Total</span>
            <span>{{ valorTotal | currency : "BRL" }}</span>
          </div>
        </section>

        <!-- Botão Finalizar -->
        <button
          nz-button
          nzType="primary"
          nzSize="large"
          [nzLoading]="carregando"
          [disabled]="carregando || !vendaForm.valid"
          type="submit"
          class="btn-finalizar"
        >
          Finalizar Compra
        </button>
      </form>
    </ng-container>
  </nz-card>
</div>
